(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-309a70c6"],{"16ca":function(t,e,a){},"212e":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container-maker"},[a("deposit-modal",{ref:"deposit",attrs:{values:t.activeValues,"calc-collat-ratio-dai-chg":t.calcCollatRatioDaiChg,"calc-collat-ratio-eth-chg":t.calcCollatRatioEthChg,"calc-liquidation-price-eth-chg":t.calcLiquidationPriceEthChg,"calc-liquidation-price-dai-chg":t.calcLiquidationPriceDaiChg,"tokens-with-balance":t.tokensWithBalance},on:{lockEth:t.lockEth}}),a("generate-modal",{ref:"generate",attrs:{values:t.activeValues,"calc-collat-ratio-dai-chg":t.calcCollatRatioDaiChg,"calc-collat-ratio-eth-chg":t.calcCollatRatioEthChg,"calc-liquidation-price-eth-chg":t.calcLiquidationPriceEthChg,"calc-liquidation-price-dai-chg":t.calcLiquidationPriceDaiChg,"tokens-with-balance":t.tokensWithBalance},on:{drawDai:t.drawDai}}),a("withdraw-modal",{ref:"withdraw",attrs:{values:t.activeValues,"calc-collat-ratio-dai-chg":t.calcCollatRatioDaiChg,"calc-collat-ratio-eth-chg":t.calcCollatRatioEthChg,"calc-liquidation-price-eth-chg":t.calcLiquidationPriceEthChg,"calc-liquidation-price-dai-chg":t.calcLiquidationPriceDaiChg,"tokens-with-balance":t.tokensWithBalance},on:{approveDai:t.approveDai,approveMkr:t.approveMkr,freeEth:t.freeEth}}),a("payback-modal",{ref:"payback",attrs:{values:t.activeValues,"calc-collat-ratio-dai-chg":t.calcCollatRatioDaiChg,"calc-collat-ratio-eth-chg":t.calcCollatRatioEthChg,"calc-liquidation-price-eth-chg":t.calcLiquidationPriceEthChg,"calc-liquidation-price-dai-chg":t.calcLiquidationPriceDaiChg,"tokens-with-balance":t.tokensWithBalance},on:{approveDai:t.approveDai,approveMkr:t.approveMkr,wipeDai:t.wipeDai}}),a("close-cdp-modal",{ref:"closeCdp",attrs:{values:t.activeValues,"calc-collat-ratio-dai-chg":t.calcCollatRatioDaiChg,"calc-collat-ratio-eth-chg":t.calcCollatRatioEthChg,"calc-liquidation-price-eth-chg":t.calcLiquidationPriceEthChg,"calc-liquidation-price-dai-chg":t.calcLiquidationPriceDaiChg,"tokens-with-balance":t.tokensWithBalance},on:{approveDai:t.approveDai,approveMkr:t.approveMkr,closeCdp:t.closeCdp}}),a("move-cdp-modal",{ref:"moveCdp",attrs:{values:t.activeValues,"calc-collat-ratio-dai-chg":t.calcCollatRatioDaiChg,"calc-collat-ratio-eth-chg":t.calcCollatRatioEthChg,"calc-liquidation-price-eth-chg":t.calcLiquidationPriceEthChg,"calc-liquidation-price-dai-chg":t.calcLiquidationPriceDaiChg,"dest-address-has-proxy":t.destAddressHasProxy,"dest-address-proxy":t.destAddressProxy,"tokens-with-balance":t.tokensWithBalance},on:{moveCdp:t.moveCdp,checkForProxy:t.checkIfDestAddressHasProxy}}),a("back-button",{attrs:{path:"/interface/dapps/"}},[a("div",{staticClass:"back-bar-container"},[t.showMoveOrClose?a("div",{staticClass:"header-buttons-container"},[a("div",{staticClass:"inner-container"},[a("button",{staticClass:"move-btn",on:{click:t.showMove}},[a("h4",[t._v(t._s(t.$t("dappsMaker.move-title")))])]),!t.hasProxy&&!t.onCreate||t.showCdpMigrateButtons?t._e():a("div",[a("button",{staticClass:"close-btn",on:{click:t.showClose}},[a("h4",[t._v(t._s(t.$t("dappsMaker.close-title")))])])])])]):t._e()])]),t.makerActive?a("div",{staticClass:"buttons-container"},[t.showCreateProxy?a("div",[a("div",{staticClass:"dapps-button",on:{click:t.buildProxy}},[a("h4",[t._v(t._s(t.$t("dappsMaker.create-proxy")))])])]):t._e(),t.showCreateProxy?a("div",{staticClass:"proxy-container"},[t._v("\n      "+t._s(t.$t("dappsMaker.proxy-instructions"))+"\n    ")]):t._e(),t.showCdpMigrateButtons?a("div",t._l(t.cdpsWithoutProxy,(function(e,i){return a("div",{key:i+e},[a("div",{staticClass:"dapps-button"},[a("div",{on:{click:function(a){return t.migrateCdpExternal(e)}}},[a("h4",[t._v("\n              "+t._s(t.$t("dappsMaker.migrate-cdp",{value:e}))+"\n            ")])])])])})),0):t._e(),t.showCdpMigrateButtons?a("div",{staticClass:"proxy-container"},[t._v("\n      "+t._s(t.$t("dappsMaker.migrate-instructions"))+"\n    ")]):t._e()]):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:t.makerActive,expression:"makerActive"}],staticClass:"buttons-container"},[t.showCreateProxy&&t.cdpsWithoutProxy.length>1?a("div",t._l(t.cdpsWithoutProxy,(function(e,i){return a("div",{key:i+e},[a("div",{class:["dapps-button",t.activeValues.cdpId===e?"active":""]},[a("div",{on:{click:function(a){return t.openMigrate(e)}}},[a("h4",[t._v(t._s(t.$t("dappsMaker.cdp"))+" #"+t._s(e))])])])])})),0):t._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.makerActive&&t.listCdps,expression:"makerActive && listCdps"}],staticClass:"buttons-container"},t._l(t.cdps,(function(e,i){return a("div",{key:i+e},[a("div",{class:["dapps-button",t.activeValues.cdpId===e?"active":""]},[a("div",{on:{click:function(a){return t.openManage(e)}}},[a("h4",[t._v(t._s(t.$t("dappsMaker.cdp"))+" #"+t._s(e))])])])])})),0),a("router-view",{attrs:{"build-empty":t.buildEmpty,"maker-active":t.makerActive,"eth-price":t.ethPrice,"peth-price":t.pethPrice,"peth-min":t.pethMin,"weth-to-peth-ratio":t.wethToPethRatio,"liquidation-penalty":t.liquidationPenalty,"stability-fee":t.stabilityFee,"liquidation-ratio":t.liquidationRatio,"price-service":t.priceService,"cdp-service":t.cdpService,"proxy-service":t.proxyService,cdps:t.cdps,"cdp-details-loaded":t.cdpDetailsLoaded,"tokens-with-balance":t.tokensWithBalance,"migration-in-progress":t.migrationInProgress,"open-close-modal":t.openCloseModal,"open-move-modal":t.openMoveModal,"values-updated":t.valuesUpdated,values:t.activeValues,"get-cdp":t.getCdp,"has-cdp":t.hasCdp,"loading-message1":t.$t("dappsMaker.initial-loading-one"),"loading-message2":t.$t("dappsMaker.initial-loading-two")},on:{activeCdpId:t.setupCdpManage,cdpOpened:t.addCdp,cdpClosed:t.removeCdp,modalHidden:t.modalHidden,managerUpdate:t.doUpdate,showWithdraw:t.showWithdraw,showPayback:t.showPayback,showGenerate:t.showGenerate,showDeposit:t.showDeposit,migrateCdp:t.migrateCdpExternal}})],1)},n=[],r=(a("8e6e"),a("6b54"),a("75fc")),s=(a("456d"),a("ac6a"),a("6762"),a("2fdb"),a("96cf"),a("3b8d")),o=(a("7f7f"),a("bd86")),c=a("2f62"),u=a("572c"),l=a("55c1"),h=a("539d"),d=a("c8e5"),p=a("2ef3"),v=a("0641"),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-container"},[a("b-modal",{ref:"modal",staticClass:"bootstrap-modal nopadding",attrs:{title:t.$t("dappsMaker.generate-title"),centered:"","hide-footer":"",static:"",lazy:""}},[a("div",{staticClass:"contents"},[a("div",{staticClass:"inputs"},[a("div",{staticClass:"interface__block-title"},[t._v("\n          "+t._s(t.$t("dappsMaker.generate-question"))+"\n        ")]),a("div",{staticClass:"top-buttons"},[a("p",{staticClass:"total"},[a("span",[t._v(t._s(t.$t("dappsMaker.total")))]),t._v("\n            "+t._s(t.newTotal)+"\n            "+t._s(t.$t("dappsMaker.dai"))+"\n          ")]),a("p",{staticClass:"max",on:{click:t.maxDai}},[t._v("\n            "+t._s(t.$t("dappsMaker.max-balance"))+"\n          ")])]),a("div",{class:["input-box",t.allOk?"":"danger"]},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],domProps:{value:t.amount},on:{input:function(e){e.target.composing||(t.amount=e.target.value)}}}),a("p",{staticClass:"input-unit"},[t._v(t._s(t.$t("dappsMaker.dai")))])]),a("div",{staticClass:"sub-text"},[t.canGenerateDaiAmount?t._e():a("p",{staticClass:"above-max"},[t._v("\n            "+t._s(t.$t("dappsMaker.above-max-dai"))+"\n          ")]),a("p",[t._v("\n            "+t._s(t.$t("dappsMaker.collateral-ratio-val",{value:t.newCollateralRatio}))+"\n          ")])])]),a("expanding-option",{attrs:{title:"Details"}},[a("div",{staticClass:"detail-container"},[a("div",{staticClass:"grid-block"},[a("p",[t._v(t._s(t.$t("dappsMaker.max-generate-available")))]),a("p",[a("b",[t._v("\n                "+t._s(t.values.maxDai?t.displayFixedValue(t.values.maxDai):0)+"\n              ")]),t._v("\n              "+t._s(t.$t("dappsMaker.dai"))+"\n            ")])]),a("div",{staticClass:"grid-block"},[a("p",[t._v(t._s(t.$t("dappsMaker.projected-liquidation")))]),a("p",[a("b",[t._v(t._s(t.displayFixedValue(t.newLiquidationPrice,2)))]),t._v("\n              "+t._s(t.fiatCurrency)+"\n            ")])]),a("div",{staticClass:"grid-block"},[a("p",[t._v(t._s(t.$t("dappsMaker.projected-collat-ratio")))]),a("p",[a("b",[t._v(t._s(t.newCollateralRatio)+"%")])])])])]),!t.newCollateralRatioSafe&&t.notZero(t.amount)?a("div",{staticClass:"warning-confirmation"},[a("div",{staticClass:"grid-block"},[a("div",{staticClass:"sign"},[t._v("⚠️")]),a("div",{staticClass:"text-content"},[a("p",{staticClass:"title"},[t._v(t._s(t.$t("dappsMaker.caution")))]),a("p",{staticClass:"warning-details"},[t._v("\n              "+t._s(t.$t("dappsMaker.liquidation-risk",{value:t.newCollateralRatio}))+"\n            ")]),a("check-box",{on:{changeStatus:t.checkBoxClicked},scopedSlots:t._u([{key:"terms",fn:function(){return[a("p",{staticClass:"checkbox-label"},[t._v("\n                  "+t._s(t.$t("dappsMaker.understand-and-agree"))+"\n                ")])]},proxy:!0}],null,!1,3911530358)})],1)])]):t._e(),a("div",{staticClass:"buttons"},[a("standard-button",{attrs:{options:t.cancelButton,"click-function":t.closeModal}}),a("standard-button",{attrs:{options:t.generateButton,"button-disabled":!t.canProceed,"click-function":t.submitBtn}})],1),a("help-center-button")],1)])],1)},f=[],g=a("70c1"),y=a.n(g),x=a("1768"),b=a("a8f0"),k=a("76ed"),C=a("32d2"),w=a("901e"),P=a.n(w),_=a("c16c");function R(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function D(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?R(a,!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):R(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var M=function(t){return new P.a(t)},O={components:{"help-center-button":k["a"],"check-box":C["a"],"expanding-option":x["a"],"standard-button":b["a"]},props:{tokensWithBalance:{type:Array,default:function(){return[]}},action:{type:String,default:""},values:{type:Object,default:function(){return{maxPethDraw:"",maxEthDraw:"",maxUsdDraw:"",ethCollateral:"",pethCollateral:"",usdCollateral:"",debtValue:"",maxDai:"",collateralRatio:"",cdpId:""}}},calcCollatRatioEthChg:{type:Function,default:function(){}},calcLiquidationPriceEthChg:{type:Function,default:function(){}},calcCollatRatioDaiChg:{type:Function,default:function(){}},calcLiquidationPriceDaiChg:{type:Function,default:function(){}}},data:function(){return{amount:0,amountEth:0,amountDai:0,riskyBypass:!1,modalDetailInformation:!1,textValues:{},fiatCurrency:"USD",digitalCurrency:"ETH",cancelButton:{title:"Cancel",buttonStyle:"green-border",noMinWidth:!0},generateButton:{title:"Generate",buttonStyle:"green",noMinWidth:!0}}},computed:D({},Object(c["b"])(["account","gasPrice","web3","network","ens"]),{amountPresent:function(){return(this.amount||""!==this.amount)&&!M(this.amount).lte(0)},canCompute:function(){return this.values&&this.amountPresent},allOk:function(){return!this.amountPresent||this.newCollateralRatioSafe&&this.canGenerateDaiAmount},showWarning:function(){return!this.newCollateralRatioInvalid&&this.canGenerateDaiAmount&&this.riskyBypass},newTotal:function(){return M(this.values.debtValue).plus(this.amount)},hasEnoughEth:function(){if(this.canCompute){var t=y.a.fromWei(this.account.balance,"ether");return M(this.amount).lte(M(t))}return!0},canGenerateDaiAmount:function(){return!(this.canCompute&&!M(this.amount).isNaN())||M(this.amount).lte(M(this.values.maxDai))},canProceed:function(){return!!this.canCompute&&(!M(this.amount).lte(0)&&(this.newCollateralRatioSafe&&this.canGenerateDaiAmount||!this.newCollateralRatioInvalid&&this.canGenerateDaiAmount&&this.riskyBypass))},calcCollateralRatio:function(){return this.canCompute?this.calcCollatRatioDaiChg(M(this.values.debtValue).plus(this.amount)):this.values?this.values.collateralRatio:void 0},newCollateralRatio:function(){return this.canCompute||this.values?this.displayFixedPercent(this.calcCollateralRatio):"--"},newCollateralRatioSafe:function(){return!this.canCompute||this.calcCollateralRatio.gte(2)},newCollateralRatioInvalid:function(){return!this.canCompute||this.calcCollateralRatio.lte(1.5)},newLiquidationPrice:function(){return this.canCompute?this.calcLiquidationPriceDaiChg(M(this.values.debtValue).plus(this.amount)):this.values?this.values.liquidationPrice:0}}),methods:{submitBtn:function(){this.canProceed&&this.drawDai()},checkBoxClicked:function(t){this.riskyBypass=t},displayPercentValue:_["e"],displayFixedValue:_["d"],displayFixedPercent:_["c"],notZero:function(t){return M(t).gt(0)},maxDai:function(){this.amount=M(this.values.maxDai).minus(M(this.values.maxDai).times(.01)),this.$forceUpdate()},currentDai:function(){this.amount=this.values.debtValue},drawDai:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:M(this.amount).gte(0)&&(this.delayCloseModal(),this.newCollateralRatioSafe?this.$emit("drawDai",[this.amount,null]):this.$emit("drawDai",[this.amount,this.riskyBypass]));case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),closeModal:function(){this.$refs.modal.hide()},delayCloseModal:function(){var t=this;setTimeout((function(){t.closeModal()}),200)}}},j=O,A=(a("9393d"),a("2877")),E=Object(A["a"])(j,m,f,!1,null,"011db2c2",null),S=E.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-container"},[a("b-modal",{ref:"modal",staticClass:"bootstrap-modal nopadding",attrs:{title:t.$t("dappsMaker.deposit-title"),centered:"","hide-footer":"",static:"",lazy:""}},[a("div",{staticClass:"modal-content-container"},[a("div",{staticClass:"inputs-container"},[a("div",{staticClass:"input-container"},[a("div",{staticClass:"interface__block-title"},[t._v("\n            "+t._s(t.$t("dappsMaker.deposit-question"))+"\n          ")]),a("div",{class:["input-box",t.hasEnoughEth?"":"danger"]},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],domProps:{value:t.amount},on:{input:function(e){e.target.composing||(t.amount=e.target.value)}}}),a("span",{staticClass:"input-unit"},[t._v(t._s(t.digitalCurrency))])]),a("div",{staticClass:"sub-text"},[t.hasEnoughEth?t._e():a("p",{staticClass:"above-max"},[t._v("\n              "+t._s(t.$t("dappsMaker.notEnoughEth"))+"\n            ")]),a("div",{staticClass:"peth"},[a("p",[t._v("\n                "+t._s(t.values.toPeth?t.displayFixedValue(t.values.toPeth(t.amount),5,!1):0)+"\n                "+t._s(t.$t("common.currency.peth"))+"\n              ")]),a("popover",{attrs:{popcontent:t.$t("dappsMaker.peth-popover")}})],1)])])]),a("div",{staticClass:"detail-info"},[a("div",{staticClass:"info"},[a("h4",[t._v(t._s(t.$t("dappsMaker.detail-info")))]),a("div",{staticClass:"sliding-switch-white"},[a("label",{staticClass:"switch"},[a("input",{attrs:{type:"checkbox"},on:{click:function(e){t.modalDetailInformation=!t.modalDetailInformation}}}),a("span",{staticClass:"slider round"})])])]),a("div",{staticClass:"expended-info",class:t.modalDetailInformation&&"expended-info-open"},[a("div",{staticClass:"padding-container"},[a("div",{staticClass:"grid-block"},[a("p",[t._v(t._s(t.$t("dappsMaker.currently-deposited")))]),a("p",[a("b",[t._v(t._s(t.displayFixedValue(t.values.ethCollateral,5)))]),t._v("\n                "+t._s(t.digitalCurrency)+"\n              ")])]),a("div",{staticClass:"grid-block"},[a("p",[t._v(t._s(t.$t("dappsMaker.projected-liquidation")))]),a("p",[a("b",[t._v(t._s(t.displayFixedValue(t.newLiquidationPrice,2)))]),t._v("\n                "+t._s(t.fiatCurrency)+"\n              ")])]),a("div",{staticClass:"grid-block"},[a("p",[t._v(t._s(t.$t("dappsMaker.projected-collat-ratio")))]),a("p",[a("b",[t._v(t._s(t.displayFixedValue(t.displayPercentValue(t.newCollateralRatio),3))+"%")])])])])])]),a("div",{staticClass:"buttons"},[a("standard-button",{attrs:{options:t.cancelButton,"click-function":t.closeModal}}),a("standard-button",{attrs:{options:t.submitButton,"button-disabled":!t.canProceed,"click-function":t.submitBtn}})],1),a("help-center-button")],1)])],1)},q=[];function B(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function V(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?B(a,!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):B(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var T=function(t){return new P.a(t)},W={components:{"help-center-button":k["a"],"check-box":C["a"],"standard-button":b["a"]},props:{tokensWithBalance:{type:Array,default:function(){return[]}},action:{type:String,default:""},values:{type:Object,default:function(){return{maxPethDraw:"",maxEthDraw:"",maxUsdDraw:"",ethCollateral:"",pethCollateral:"",usdCollateral:"",debtValue:"",maxDai:"",collateralRatio:"",cdpId:""}}},calcCollatRatioEthChg:{type:Function,default:function(){}},calcLiquidationPriceEthChg:{type:Function,default:function(){}},calcCollatRatioDaiChg:{type:Function,default:function(){}},calcLiquidationPriceDaiChg:{type:Function,default:function(){}}},data:function(){return{amount:0,amountEth:0,amountDai:0,riskyBypass:!1,modalDetailInformation:!1,textValues:{},fiatCurrency:"USD",digitalCurrency:"ETH",cancelButton:{title:"Cancel",buttonStyle:"green-border",noMinWidth:!0},submitButton:{title:"Submit",buttonStyle:"green",noMinWidth:!0}}},computed:V({},Object(c["b"])(["account","gasPrice","web3","network","ens"]),{amountPresent:function(){return(this.amount||""!==this.amount)&&!T(this.amount).lte(0)},hasEnoughEth:function(){if(this.amount||""!==this.amount){var t=y.a.fromWei(this.account.balance,"ether");return T(this.amount).lte(T(t))}return!0},canWithdrawEthAmount:function(){return!(!this.amount&&""===this.amount)&&T(this.amount).lte(T(this.values.ethCollateral))},canProceed:function(){if(T(this.amount).lte(0))return!1;var t=T(this.newCollateralRatio),e=t.gt(1.5)||t.eq(0);return this.hasEnoughEth&&(e||this.riskyBypass)},newCollateralRatio:function(){return this.values&&this.amount>0?this.calcCollatRatioEthChg(T(this.values.ethCollateral).plus(this.amount)):this.values?this.values.collatRatio:0},newCollateralRatioSafe:function(){return this.values&&this.amount>0?this.calcCollatRatioEthChg(T(this.values.ethCollateral).plus(this.amount)).gte(2):!this.values||T(this.values.collatRatio).gte(2)},newCollateralRatioInvalid:function(){return this.values&&this.amount>0?this.calcCollatRatioEthChg(T(this.values.ethCollateral).plus(this.amount)).lte(1.5):!this.values||T(this.values.collatRatio).lte(1.5)},newLiquidationPrice:function(){return this.values&&this.amount>0?this.calcLiquidationPriceEthChg(T(this.values.ethCollateral).plus(T(this.amount))):this.values?this.values.liquidationPrice:0}}),watch:{},mounted:function(){var t=this;this.$refs.modal.$on("shown",(function(){t.amount=0}))},methods:{submitBtn:function(){this.canProceed&&this.lockEth()},checkBoxClicked:function(){this.riskyBypass=!this.riskyBypass},displayPercentValue:_["e"],displayFixedValue:_["d"],notZero:function(t){return T(t).gt(0)},currentDai:function(){this.amount=this.values.debtValue},lockEth:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:T(this.amount).gte(0)&&(this.delayCloseModal(),this.$emit("lockEth",this.amount));case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),closeModal:function(){this.$refs.modal.hide()},delayCloseModal:function(){var t=this;setTimeout((function(){t.closeModal()}),200)}}},F=W,I=(a("d2bc"),Object(A["a"])(F,$,q,!1,null,"61b0f31e",null)),U=I.exports,L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-container"},[a("b-modal",{ref:"modal",staticClass:"bootstrap-modal nopadding",attrs:{title:t.$t("dappsMaker.withdraw-title"),centered:"","hide-footer":"",static:"",lazy:""}},[a("div",{staticClass:"modal-content-container"},[a("div",{staticClass:"inputs-container"},[a("div",{staticClass:"input-container"},[a("p",{staticClass:"message"},[t._v("\n            "+t._s(t.$t("dappsMaker.withdraw-notice"))+"\n          ")]),a("label",[t._v(" "+t._s(t.$t("dappsMaker.withdraw-question")))]),a("div",{staticClass:"top-buttons"},[a("p",{staticClass:"max-withdraw",on:{click:t.maxWithdraw}},[t._v("\n              "+t._s(t.$t("dappsMaker.max-withdraw"))+"\n            ")])]),a("div",{class:["input-box",t.newCollateralRatioSafe?"":"danger"]},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],domProps:{value:t.amount},on:{input:function(e){e.target.composing||(t.amount=e.target.value)}}}),a("span",{staticClass:"input-unit"},[t._v(t._s(t.digitalCurrency))])]),a("div",{staticClass:"sub-text"},[t.canWithdrawEthNotice?a("p",{staticClass:"above-max"},[t._v("\n              "+t._s(t.$t("dappsMaker.over-max-withdraw"))+"\n            ")]):t._e(),a("div",{staticClass:"peth"},[a("p",{staticClass:"peth-value"},[t._v("\n                "+t._s(t.values.toPeth?t.displayFixedValue(t.values.toPeth(t.amount),5,!1):0)+"\n                "+t._s(t.$t("dappsMaker.peth"))+"\n              ")]),a("popover",{attrs:{popcontent:t.$t("dappsMaker.peth-popover")}})],1)])])]),a("expanding-option",{attrs:{title:"Detail Information"}},[a("div",{staticClass:"padding-container"},[a("div",{staticClass:"grid-block"},[a("p",[t._v(t._s(t.$t("dappsMaker.max-withdraw-available")))]),a("p",[a("b",[t._v(t._s(t.values.maxDai?t.displayFixedValue(t.values.maxEthDraw,5):0))]),t._v("\n              "+t._s(t.digitalCurrency)+"\n            ")])]),a("div",{staticClass:"grid-block"},[a("p",[t._v(t._s(t.$t("dappsMaker.projected-liquidation")))]),a("p",[a("b",[t._v(t._s(t.displayFixedValue(t.newLiquidationPrice,2)))]),t._v("\n              "+t._s(t.fiatCurrency)+"\n            ")])]),a("div",{staticClass:"grid-block"},[a("p",[t._v(t._s(t.$t("dappsMaker.projected-collat-ratio")))]),a("p",[a("b",[t._v(t._s(t.displayFixedValue(t.displayPercentValue(t.newCollateralRatio),3))+"%")])])])])]),!t.newCollateralRatioSafe&&t.notZero(t.amount)?a("div",{staticClass:"warning-confirmation"},[a("div",{staticClass:"grid-block"},[a("div",{staticClass:"sign"},[t._v("⚠️")]),a("div",{staticClass:"text-content"},[a("p",{staticClass:"title"},[t._v(t._s(t.$t("dappsMaker.caution")))]),a("p",{staticClass:"warning-details"},[t._v("\n              "+t._s(t.$t("dappsMaker.liquidation-risk",{value:t.displayFixedValue(t.displayPercentValue(t.newCollateralRatio))}))+"\n            ")]),a("check-box",{on:{changeStatus:t.checkBoxClicked},scopedSlots:t._u([{key:"terms",fn:function(){return[a("p",{staticClass:"checkbox-label"},[t._v("\n                  "+t._s(t.$t("dappsMaker.understand-and-agree"))+"\n                ")])]},proxy:!0}],null,!1,3911530358)})],1)])]):t._e(),a("div",{staticClass:"buttons"},[a("standard-button",{attrs:{options:t.cancelButton,"click-function":t.closeModal}}),a("standard-button",{attrs:{options:t.submitButton,"button-disabled":!t.canProceed,"click-function":t.submitBtn}})],1),a("help-center-button")],1)])],1)},N=[];function H(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function G(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?H(a,!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):H(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var z=function(t){return new P.a(t)},Q={components:{"help-center-button":k["a"],"check-box":C["a"],"expanding-option":x["a"],"standard-button":b["a"]},props:{tokensWithBalance:{type:Array,default:function(){return[]}},action:{type:String,default:""},values:{type:Object,default:function(){return{maxPethDraw:"",maxEthDraw:"",maxUsdDraw:"",ethCollateral:"",pethCollateral:"",usdCollateral:"",debtValue:"",maxDai:"",collateralRatio:"",cdpId:""}}},calcCollatRatioEthChg:{type:Function,default:function(){}},calcLiquidationPriceEthChg:{type:Function,default:function(){}},calcCollatRatioDaiChg:{type:Function,default:function(){}},calcLiquidationPriceDaiChg:{type:Function,default:function(){}}},data:function(){return{amount:0,amountEth:0,amountDai:0,riskyBypass:!1,modalDetailInformation:!1,textValues:{},fiatCurrency:"USD",digitalCurrency:"ETH",cancelButton:{title:"Cancel",buttonStyle:"green-border",noMinWidth:!0},submitButton:{title:"Submit",buttonStyle:"green",noMinWidth:!0}}},computed:G({},Object(c["b"])(["account","gasPrice","web3","network","ens"]),{amountPresent:function(){return(this.amount||""!==this.amount)&&!z(this.amount).lte(0)},canCompute:function(){return this.values&&this.amountPresent},canWithdrawEthNotice:function(){return!!this.amountPresent&&!z(this.amount).lte(z(this.values.maxEthDraw))},canWithdrawEthAmount:function(){return!!this.amountPresent&&z(this.amount).lte(z(this.values.ethCollateral))},canProceed:function(){return!!this.amountPresent&&(!z(this.amount).lte(0)&&(this.newCollateralRatioSafe&&this.canWithdrawEthAmount||!this.newCollateralRatioInvalid&&this.canWithdrawEthAmount&&this.riskyBypass))},calcCollateralRatio:function(){return this.canCompute?this.calcCollatRatioDaiChg(z(this.values.debtValue).plus(this.amount)):this.values?this.values.collateralRatio:void 0},newCollateralRatio:function(){return this.canCompute?this.calcCollatRatioEthChg(z(this.values.ethCollateral).minus(this.amount)):this.values?this.values.collatRatio:"--"},newCollateralRatioSafe:function(){return!this.canCompute||(!!this.values.zeroDebt||this.newCollateralRatio.gte(2))},newCollateralRatioInvalid:function(){return!this.canCompute||!this.values.zeroDebt&&this.newCollateralRatio.lte(1.5)},newLiquidationPrice:function(){return this.canCompute?this.calcLiquidationPriceEthChg(z(this.values.ethCollateral).minus(this.amount)):this.values?this.values.liquidationPrice:0}}),watch:{},mounted:function(){var t=this;this.$refs.modal.$on("shown",(function(){t.amount=0})),this.$refs.modal.$on("hidden",(function(){t.amount=0}))},methods:{submitBtn:function(){this.canProceed&&this.freeEth()},checkBoxClicked:function(t){this.riskyBypass=t},displayPercentValue:_["e"],displayFixedValue:_["d"],notZero:function(t){return z(t).gt(0)},maxWithdraw:function(){this.amount=this.values.maxEthDraw,this.$forceUpdate()},currentDai:function(){this.amount=this.values.debtValue},freeEth:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:z(this.amount).gte(0)&&(this.delayCloseModal(),this.newCollateralRatioSafe?this.$emit("freeEth",[this.amount,null]):this.$emit("freeEth",[this.amount,this.riskyBypass]));case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),closeModal:function(){this.$refs.modal.hide()},delayCloseModal:function(){var t=this;setTimeout((function(){t.closeModal()}),200)}}},Z=Q,K=(a("2fb38"),Object(A["a"])(Z,L,N,!1,null,"02e2bdb6",null)),J=K.exports,Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-container"},[a("b-modal",{ref:"modal",staticClass:"bootstrap-modal nopadding",attrs:{title:t.$t("dappsMaker.payback-title"),centered:"","hide-footer":"",static:"",lazy:""}},[a("div",{staticClass:"contents"},[a("p",{staticClass:"top-message"},[t._v("\n        "+t._s(t.$t("dappsMaker.payback-notice"))+"\n      ")]),t.hasEnoughMkr?t._e():a("div",[a("div",{staticClass:"value-block"},[a("p",[a("b",[t._v(t._s(t.$t("dappsMaker.mkr-balance")))])]),a("p",[a("b",[t._v(t._s(t.mkrBalance)+" "+t._s(t.$t("dappsMaker.mkr")))])])]),a("p",{staticClass:"get-mkr",on:{click:function(e){return t.getMkr()}}},[t._v("\n          "+t._s(t.$t("dappsMaker.get-mkr"))+"\n        ")])]),a("div",{staticClass:"input-container"},[a("div",{staticClass:"top-buttons"},[a("p",{on:{click:t.currentDai}},[t._v(t._s(t.$t("dappsMaker.set-max")))])]),a("div",{class:["dai-amount",t.hasEnoughDai?"":"danger"]},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],domProps:{value:t.amount},on:{input:function(e){e.target.composing||(t.amount=e.target.value)}}}),a("p",{staticClass:"floating-text"},[t._v(t._s(t.$t("dappsMaker.dai")))])])]),a("expanding-option",{attrs:{title:"Detail Information"}},[a("ul",{staticClass:"details"},[a("li",[a("p",[t._v(t._s(t.$t("dappsMaker.outstanding-dai")))]),a("p",[a("b",[t._v(t._s(t.values.debtValue?t.displayFixedValue(t.values.debtValue,3):0))]),t._v("\n              "+t._s(t.$t("dappsMaker.dai"))+"\n            ")])]),a("li",[a("p",[t._v(t._s(t.$t("dappsMaker.stability-fee-owed")))]),a("p",[a("b",[t._v(t._s(t.values.governanceFeeOwed))]),t._v(" "+t._s(t.$t("dappsMaker.mkr"))+"\n            ")])]),a("li",[a("p",[t._v(t._s(t.$t("dappsMaker.projected-liquidation")))]),a("p",[a("b",[t._v(t._s(t.displayFixedValue(t.newLiquidationPrice,2)))]),t._v("\n              "+t._s(t.fiatCurrency)+"\n            ")])]),a("li",[a("p",[t._v(t._s(t.$t("dappsMaker.projected-collat-ratio")))]),a("p",[a("b",[t._v(t._s(t.displayFixedValue(t.displayPercentValue(t.newCollateralRatio),3))+"%")])])])])]),a("div",{staticClass:"buttons"},[t.needsDaiApprove?a("div",[a("standard-button",{attrs:{options:t.approveDaiButton},nativeOn:{click:function(e){return t.approveDai(e)}}})],1):t._e(),t.needsMkrApprove?a("div",[a("standard-button",{attrs:{options:t.approveMkrButton},nativeOn:{click:function(e){return t.approveMkr(e)}}})],1):t._e()]),a("div",{staticClass:"buttons"},[a("standard-button",{attrs:{options:t.cancelButton,"click-function":t.closeModal}}),a("standard-button",{attrs:{options:t.submitButton,"button-disabled":!t.canProceed,"click-function":t.submitBtn}})],1),a("help-center-button")],1)])],1)},X=[];a("7514");function tt(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function et(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?tt(a,!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):tt(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var at=function(t){return new P.a(t)},it={components:{"help-center-button":k["a"],"check-box":C["a"],"expanding-option":x["a"],"standard-button":b["a"]},props:{tokensWithBalance:{type:Array,default:function(){return[]}},action:{type:String,default:""},values:{type:Object,default:function(){return{maxPethDraw:"",maxEthDraw:"",maxUsdDraw:"",ethCollateral:"",pethCollateral:"",usdCollateral:"",debtValue:"",maxDai:"",collateralRatio:"",cdpId:""}}},calcCollatRatioEthChg:{type:Function,default:function(){}},calcLiquidationPriceEthChg:{type:Function,default:function(){}},calcCollatRatioDaiChg:{type:Function,default:function(){}},calcLiquidationPriceDaiChg:{type:Function,default:function(){}}},data:function(){return{amount:0,amountEth:0,amountDai:0,mkrToken:{},daiToken:{},riskyBypass:!1,modalDetailInformation:!1,textValues:{},fiatCurrency:"USD",digitalCurrency:"ETH",cancelButton:{title:"Cancel",buttonStyle:"green-border",noMinWidth:!0,fullWidth:!0},submitButton:{title:"Submit",buttonStyle:"green",noMinWidth:!0,fullWidth:!0},approveMkrButton:{title:"Approve Maker",buttonStyle:"green-border",fullWidth:!0,noMinWidth:!0},approveDaiButton:{title:"Approve Dai",buttonStyle:"green-border",fullWidth:!0,noMinWidth:!0},suppliedFrom:{symbol:"ETH",name:"Ethereum"},suppliedTo:{symbol:"MKR",name:"Maker"},suppliedToAmount:0,destAddress:""}},computed:et({},Object(c["b"])(["account","gasPrice","web3","network","ens"]),{amountPresent:function(){return(this.amount||""!==this.amount)&&!at(this.amount).lte(0)},canCompute:function(){return this.values&&this.amountPresent},allOk:function(){return!this.amountPresent||this.newCollateralRatioSafe&&this.canGenerateDaiAmount},hasEnoughEth:function(){if(this.canCompute){var t=y.a.fromWei(this.account.balance,"ether");return at(this.amount).lte(at(t))}return!0},paybackFee:function(){return this.canCompute?at(this.amount).div(this.values.debtValue).times(this.values.governanceFeeOwed):0},hasEnoughMkr:function(){return!this.canCompute||at(this.mkrBalance).gte(at(this.paybackFee))},hasEnoughDai:function(){return!this.canCompute||at(this.amount).lte(at(this.daiBalance))},canWithdrawEthAmount:function(){return!!this.canCompute&&at(this.amount).lte(at(this.values.ethCollateral))},canGenerateDaiAmount:function(){return!this.canCompute||at(this.amount).lte(at(this.values.maxDai))},canProceed:function(){return this.hasEnoughDai},calcCollateralRatio:function(){return this.canCompute?this.calcCollatRatioDaiChg(at(this.values.debtValue).minus(this.amount)):this.values?this.values.collateralRatio:"--"},newCollateralRatio:function(){return this.amount>0?this.calcCollateralRatio:this.values?this.values.collatRatio:"--"},newCollateralRatioSafe:function(){return this.amount>0?!!this.calcCollateralRatio.lte(new P.a(9e-6))||this.calcCollateralRatio.gte(2):!this.values||at(this.values.collatRatio).gte(2)},newCollateralRatioInvalid:function(){return this.amount>0?!!this.calcCollateralRatio.lte(new P.a(9e-6))||this.calcCollateralRatio.gte(1.5):!this.values||at(this.values.collatRatio).lte(1.5)},newLiquidationPrice:function(){return this.values.debtValue&&this.amount>0?this.calcLiquidationPriceDaiChg(at(this.values.debtValue).minus(this.amount)):this.values.liquidationPrice?this.values.liquidationPrice:0},mkrBalance:function(){return this.mkrToken?this.mkrToken.balance:0},daiBalance:function(){return this.daiToken?this.daiToken.balance:0},needsDaiApprove:function(){return!(!at(this.values.proxyAllowanceDai).gt(0)||!at(this.values.proxyAllowanceDai).lt(this.values.debtValue))||at(this.values.proxyAllowanceDai).eq(0)},needsMkrApprove:function(){return!(!at(this.values.proxyAllowanceMkr).gt(0)||!at(this.values.proxyAllowanceMkr).lt(this.values.governanceFeeOwed))||at(this.values.proxyAllowanceMkr).eq(0)}}),watch:{},mounted:function(){var t=this;this.$refs.modal.$on("shown",(function(){t.amount=0,t.getBalances()}))},methods:{submitBtn:function(){this.canProceed&&this.wipeDai()},checkBoxClicked:function(){this.riskyBypass=!this.riskyBypass},displayPercentValue:_["e"],displayFixedValue:_["d"],notZero:function(t){return at(t).gt(0)},maxDai:function(){this.amount=at(this.values.maxDai).minus(at(this.values.maxDai).times(.01))},currentDai:function(){this.amount=this.values.debtValue},wipeDai:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:at(this.amount).gte(0)&&(this.delayCloseModal(),at(this.amount).gt(this.values.debtValue)?this.$emit("wipeDai",this.values.debtValue):this.$emit("wipeDai",this.amount));case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getBalances:function(){this.mkrToken=this.tokensWithBalance.find((function(t){return"MKR"===t.symbol})),this.daiToken=this.tokensWithBalance.find((function(t){return"DAI"===t.symbol}))},getMkr:function(){var t=this.paybackFee;at(this.mkrBalance).lt(t)&&(this.suppliedToAmount=at(t).minus(at(this.mkrBalance)).plus(at(t).times(.01)).toNumber(),at(this.suppliedToAmount).lt(1e-6)&&(this.suppliedToAmount=1e-6),this.suppliedFrom={symbol:"ETH",name:"Ethereum"},this.suppliedTo={symbol:"MKR",name:"Maker"},this.$eventHub.$emit("showSwapWidgetTo",this.account.address,this.suppliedFrom,this.suppliedTo,this.suppliedToAmount))},closeModal:function(){this.$refs.modal.hide()},delayCloseModal:function(){var t=this;setTimeout((function(){t.closeModal()}),200)},approveDai:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$emit("approveDai");case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),approveMkr:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$emit("approveMkr");case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},nt=it,rt=(a("71a4"),Object(A["a"])(nt,Y,X,!1,null,"290fce68",null)),st=rt.exports,ot=a("a7ac"),ct=a.n(ot),ut=a("ce96"),lt=a("d225"),ht=a("b0b4"),dt=ct.a.MKR,pt=ct.a.DAI,vt=function(t){return new P.a(t)},mt=function(){function t(e,a,i,n){Object(lt["a"])(this,t),this.cdpId=e,this.cdp={},this.web3=a||{},this.ready=!1,this.doUpdate=0,this.cdps=[],this.noProxy=n.noProxy||!1,this.services=i||null,this.needsUpdate=!1,this.closing=!1,this.opening=!1,this.migrated=!1,this.migrateCdpActive=!1,this.migrateCdpStage=0,this._liqPrice=vt(0),this.isSafe=!1,this.debtValue=vt(0),this._collatRatio=0,this.ethCollateral=vt(0),this.pethCollateral=vt(0),this._usdCollateral=vt(0),this._governanceFee=vt(0)}return Object(ht["a"])(t,[{key:"init",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:this.cdpId,t.next=3,this.updateValues(e);case 3:return t.next=5,this.cdpService.getGovernanceFee(this.cdpId,dt);case 5:return this._governanceFee=t.sent.toBigNumber(),this.ready=!0,t.abrupt("return",this);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"updateValues",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:this.cdpId,t.next=3,this.services.getProxy();case 3:if(this._proxyAddress=t.sent,this.noProxy=null===this._proxyAddress,!this._proxyAddress){t.next=11;break}return t.next=8,this.services.getCdp(e,this._proxyAddress);case 8:this.cdp=t.sent,t.next=14;break;case 11:return t.next=13,this.services.getCdp(e,!1);case 13:this.cdp=t.sent;case 14:return t.next=16,this.cdp.getLiquidationPrice();case 16:return a=t.sent,this._liqPrice=a.toBigNumber().toFixed(2),t.next=20,this.cdp.isSafe();case 20:return this.isSafe=t.sent,t.next=23,this.cdp.getDebtValue();case 23:return this.debtValue=t.sent.toBigNumber(),t.next=26,this.cdp.getCollateralizationRatio();case 26:return this._collatRatio=t.sent,t.next=29,this.cdp.getCollateralValue();case 29:return this.ethCollateral=t.sent.toBigNumber(),t.next=32,this.cdp.getCollateralValue(ct.a.PETH);case 32:return this.pethCollateral=t.sent.toBigNumber(),t.next=35,this.cdp.getCollateralValue(ct.a.USD);case 35:this._usdCollateral=t.sent.toBigNumber();case 36:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"update",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.migrated){t.next=8;break}return t.next=3,this.proxyService.currentProxy();case 3:if(e=t.sent,!e){t.next=8;break}return this.migrated=!1,t.next=8,this.cdpService.give(this.cdpId,this._proxyAddress);case 8:if(!this.needsUpdate){t.next=15;break}return this.opening=!1,this.needsUpdate=!1,t.next=13,this.updateValues(this.cdpId);case 13:return this.doUpdate++,t.abrupt("return",this);case 15:return t.abrupt("return",this);case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getProxy",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.services.getProxy();case 2:this._proxyAddress=t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"migrateCdp",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getProxy();case 2:if(e=t.sent,e){t.next=10;break}return this.needsUpdate=!0,t.next=7,this.proxyService.ensureProxy();case 7:return t.abrupt("return",t.sent);case 10:if(!this.needToFinishMigrating){t.next=14;break}return this.needsUpdate=!0,t.next=14,this.cdpService.give(this.cdpId,this._proxyAddress);case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"openCdp",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,a){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e<=0)){t.next=2;break}return t.abrupt("return",0);case 2:if(this.hasProxy){t.next=10;break}return this.opening=!0,this.needsUpdate=!0,t.next=7,this.cdpService.openProxyCdpLockEthAndDrawDai(e,a,null);case 7:i=t.sent,t.next=15;break;case 10:return this.opening=!0,this.needsUpdate=!0,t.next=14,this.cdpService.openProxyCdpLockEthAndDrawDai(e,a,this.proxyAddress);case 14:i=t.sent;case 15:return t.abrupt("return",i.id);case 16:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"lockEth",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!this.noProxy){t.next=3;break}return t.abrupt("return");case 3:return this.needsUpdate=!0,t.next=6,this.cdpService.lockEthProxy(this._proxyAddress,this.cdpId,e);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.error(t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"drawDai",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.calcCollatRatio(this.ethCollateral,this.debtValue.plus(t)).gt(2)||e)try{if(this.noProxy)return;this.needsUpdate=!0,this.cdpService.drawDaiProxy(this._proxyAddress,this.cdpId,t)}catch(a){console.error(a)}}},{key:"freeEth",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=i.length>1&&void 0!==i[1]&&i[1],!(this.debtValue.eq(0)||this.calcCollatRatio(this.ethCollateral.minus(e),this.debtValue).gt(1.5)||a)){t.next=13;break}if(t.prev=2,!this.noProxy){t.next=5;break}return t.abrupt("return");case 5:return this.needsUpdate=!0,t.next=8,this.cdpService.freeEthProxy(this._proxyAddress,this.cdpId,e);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),console.error(t.t0);case 13:case"end":return t.stop()}}),t,this,[[2,10]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"wipeDai",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!this.noProxy){t.next=3;break}return t.abrupt("return");case 3:return this.needsUpdate=!0,t.next=6,this.cdpService.wipeDaiProxy(this._proxyAddress,this.cdpId,e);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.error(t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"canCloseCdp",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.debtValue.toNumber(),t.next=3,this.cdpService.enoughMkrToWipe(this.cdpId,e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"closeCdp",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,this.needsUpdate=!0,this.closing=!0,!this.hasProxy){t.next=6;break}return t.next=6,this.cdpService.shutProxy(this._proxyAddress,this.cdpId);case 6:t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log("closeCdp Error:"),console.error(t.t0);case 12:case"end":return t.stop()}}),t,this,[[0,8]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"checkIfDestAddressHasProxy",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getProxy();case 2:return t.next=4,this.proxyService.getProxyAddress(e);case 4:return a=t.sent,t.abrupt("return",a);case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"moveCdp",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getProxy();case 2:return t.next=4,this.proxyService.getProxyAddress(e);case 4:if(a=t.sent,!a){t.next=12;break}return this.needsUpdate=!0,this.closing=!0,t.next=10,this.cdpService.giveProxy(this._proxyAddress,this.cdpId,a);case 10:t.next=23;break;case 12:if(this.noProxy){t.next=19;break}return this.needsUpdate=!0,this.closing=!0,t.next=17,this.cdpService.giveProxy(this._proxyAddress,this.cdpId,e);case 17:t.next=23;break;case 19:return this.needsUpdate=!0,this.closing=!0,t.next=23,this.cdpService.give(this.cdpId,e);case 23:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"enoughMkrToWipe",value:function(t){return this.cdpService.enoughMkrToWipe(t,pt.wei)}},{key:"toUSD",value:function(t){var e=this.services.toUSD(t);return e.lt(0)?vt(0):e}},{key:"toPeth",value:function(t){return this.services.toPeth(t)}},{key:"maxDaiDraw",value:function(){var t=vt(this.ethPrice).times(vt(this.ethCollateral)),e=vt(this.debtValue).times(vt(this.liquidationRatio));return t.minus(e).div(vt(this.ethPrice))}},{key:"calcCollatRatio",value:function(t,e){return t<=0||e<=0?vt(0):Object(_["a"])(this.ethPrice,t,e)}},{key:"calcLiquidationPrice",value:function(t,e){return t<=0||e<=0?vt(0):Object(_["b"])(t,e,this.ethPrice,this.liquidationRatio)}},{key:"approveDai",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.daiToken.approveUnlimited(this.proxyAddress);case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"approveMkr",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.mkrToken.approveUnlimited(this.proxyAddress);case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getDaiBalances",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.services.daiToken.balance();case 2:return this.daiBalance=t.sent,t.abrupt("return",this.daiBalance);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"currentAddress",get:function(){return this.services.account.address}},{key:"liquidationPenalty",get:function(){return this.services.liquidationPenalty}},{key:"stabilityFee",get:function(){return this.services.stabilityFee}},{key:"ethPrice",get:function(){return this.services.ethPrice}},{key:"pethPrice",get:function(){return this.services._pethPrice}},{key:"wethToPethRatio",get:function(){return this.services.wethToPethRatio}},{key:"liquidationRatio",get:function(){return this.services.liquidationRatio}},{key:"proxyAddress",get:function(){return this.services._proxyAddress}},{key:"hasProxy",get:function(){return this.services.hasProxy}},{key:"proxyAllowanceDai",get:function(){return this.services.proxyAllowanceDai}},{key:"proxyAllowanceMkr",get:function(){return this.services.proxyAllowanceMkr}},{key:"daiToken",get:function(){return this.services._daiToken}},{key:"daiBalance",get:function(){return this.services.daiBalance}},{key:"mkrToken",get:function(){return this.services._mkrToken}},{key:"mkrBalance",get:function(){return this.services.mkrBalance}},{key:"proxyService",get:function(){return this.services._proxyService}},{key:"cdpService",get:function(){return this.services._cdpService}},{key:"minEth",get:function(){return this.services.minEth()}},{key:"pethMin",get:function(){return this.services.pethMin}},{key:"zeroDebt",get:function(){return vt(this.debtValue).eq(0)}},{key:"usdCollateral",get:function(){return this.toUSD(this.ethCollateral)}},{key:"ethCollateralNum",get:function(){return this.ethCollateral.toNumber()}},{key:"collatRatio",get:function(){return this._collatRatio}},{key:"liquidationPrice",get:function(){return this._liqPrice}},{key:"governanceFeeOwed",get:function(){return this._governanceFee}},{key:"maxDai",get:function(){return this.ethPrice&&this.ethCollateral&&this.liquidationRatio&&this.debtValue?Object(_["f"])(this.ethPrice,this.ethCollateral,this.liquidationRatio.plus(.001),this.debtValue):vt(0)}},{key:"maxEthDraw",get:function(){return this.ethPrice&&this.debtValue&&this.liquidationRatio?this.zeroDebt?Object(_["g"])(this.ethCollateral,this.liquidationRatio,this.debtValue,this.ethPrice,this.minEth.times(0)):Object(_["g"])(this.ethCollateral,this.liquidationRatio,this.debtValue,this.ethPrice):vt(0)}},{key:"maxPethDraw",get:function(){return this.pethPrice&&this.pethCollateral&&this.liquidationRatio?this.zeroDebt?Object(_["h"])(this.pethCollateral,this.liquidationRatio,this.debtValue,this.pethPrice,this.pethMin.times(0)):Object(_["h"])(this.pethCollateral,this.liquidationRatio,this.debtValue,this.pethPrice):vt(0)}},{key:"maxUsdDraw",get:function(){return this.pethPrice&&this.pethCollateral&&this.liquidationRatio?this.toUSD(this.maxEthDraw):vt(0)}},{key:"needToFinishMigrating",get:function(){return this._proxyAddress&&this.noProxy}}],[{key:"toNumber",value:function(t){return P.a.isBigNumber(t)?t.toNumber():vt(t).toNumber()}},{key:"displayPercentValue",value:function(t){return P.a.isBigNumber(t)||(t=new P.a(t)),t.times(100).toString()}},{key:"displayFixedValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return P.a.isBigNumber(t)||(t=new P.a(t)),a?t.toFixed(e,P.a.ROUND_DOWN).toString():t.toFixed(e).toString()}}]),t}(),ft=a("b7d3"),gt=a("1383");function yt(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function xt(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?yt(a,!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):yt(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var bt=ct.a.MKR,kt=ct.a.DAI,Ct=function(t){return new P.a(t)},wt=function(t,e,a){return Ct(t).times(Ct(e)).div(Ct(a))},Pt={components:{"interface-container-title":l["a"],"interface-bottom-text":h["a"],"generate-modal":S,"deposit-modal":U,"withdraw-modal":J,"payback-modal":st,blockie:d["a"],"back-button":u["a"],"close-cdp-modal":p["a"],"move-cdp-modal":v["a"]},props:{tokensWithBalance:{type:Array,default:function(){return[]}},getBalance:{type:Function,default:function(){}},highestGas:{type:String,default:"0"}},data:function(){return{destAddressProxy:"",destAddressHasProxy:!1,afterUpdate:[],allCdpIds:[],activeCdp:{},activeValues:{maxPethDraw:Ct(0),maxEthDraw:Ct(0),maxUsdDraw:Ct(0),ethCollateral:Ct(0),pethCollateral:Ct(0),usdCollateral:Ct(0),debtValue:Ct(0),maxDai:Ct(0),collateralRatio:Ct(0),minEth:Ct(0),cdpId:"--"},availableCdps:{},cdps:[],cdpsWithoutProxy:[],cdpService:{},cdpDetailsLoaded:!1,currentProxy:null,currentCdpId:"",creatingCdp:!1,daiPrice:0,daiQty:0,ethPrice:Ct(0),ethQty:0,liquidationRatio:Ct(0),liquidationPenalty:Ct(0),makerActive:!1,makerCdp:{},makerManager:{},migrationInProgress:{},openCloseModal:!1,openMoveModal:!1,proxyService:{},proxyAddress:null,pethPrice:Ct(0),pethMin:Ct(0),priceService:{},priceFloor:0,stabilityFee:Ct(0),sysVars:{},sysServices:{},targetPrice:0,valuesUpdated:0,wethToPethRatio:Ct(0)}},computed:xt({},Object(c["b"])(["account","gasPrice","web3","network","ens"]),{maxDaiDraw:function(){return this.ethQty<=0?0:wt(this.ethPrice,this.ethQty,this.liquidationRatio)},minEthDeposit:function(){return this.daiQty<=0?0:wt(this.liquidationRatio,this.daiQty,this.ethPrice)},showMoveOrClose:function(){return"manage-sai"===this.$route.name||"migrate-sai"===this.$route.name},showManage:function(){return this.listCdps||this.cdps.length>=1&&this.cdpsWithoutProxy.length>=1},showRefresh:function(){return this.cdps.length>0||this.cdpsWithoutProxy.length>0},onCreate:function(){return"create-sai"===this.$route.name},showCreateProxy:function(){return!this.showCdpMigrateButtons&&(!this.hasProxy&&!this.onCreate)},showCdpMigrateButtons:function(){return this.hasProxy&&this.cdpsWithoutProxy.length>=1},listCdps:function(){return this.cdps.length>1||this.cdpsWithoutProxy.length>1},hasProxy:function(){return null!==this.proxyAddress},currentProxyAddress:function(){return this.proxyAddress}}),watch:Object(o["a"])({},"account.address",(function(){this.makerActive=!1,this.setup()})),destroyed:function(){this.priceService={},this.cdpService={},this.proxyService={},this.availableCdps={},this.activeCdp={},this.makerCdp={},this.sysVars={},this.sysServices={}},mounted:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.setup();case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{modalHidden:function(){this.openCloseModal=!1,this.openMoveModal=!1},gotoHome:function(){this.$router.push({name:"Maker-sai"})},gotoCreate:function(){this.$route.path.includes("maker-sai")&&(this.activeValues=this.systemValues,this.$router.push({name:"create-sai"}))},goToManage:function(){this.$route.path.includes("maker-sai")&&(1===this.cdps.length?this.$router.push({name:"manage-sai",params:{cdpId:this.cdps[0]}}):1===this.cdpsWithoutProxy.length?this.$router.push({name:"migrate-sai",params:{cdpId:this.cdpsWithoutProxy[0]}}):this.showManage?this.$router.push({name:"select-sai"}):this.gotoCreate())},openManage:function(t){this.$route.path.includes("maker-sai")&&(this.setupCdpManage(t),this.$router.push({name:"manage-sai",params:{cdpId:t}}))},openMigrate:function(t){this.$route.path.includes("maker-sai")&&(this.setupCdpManage(t),this.$router.push({name:"migrate-sai",params:{cdpId:t}}))},showDeposit:function(){this.$refs.deposit.$refs.modal.show()},showWithdraw:function(){this.$refs.withdraw.$refs.modal.show()},showPayback:function(){this.$refs.payback.$refs.modal.show()},showGenerate:function(){this.$refs.generate.$refs.modal.show()},showClose:function(){var t=this;this.$refs.closeCdp.$refs.modal.$on("hidden",(function(){t.$emit("modalHidden")})),this.$refs.closeCdp.$refs.modal.show()},showMove:function(){var t=this;this.$refs.moveCdp.$refs.modal.$on("hidden",(function(){t.$emit("modalHidden")})),this.destAddressHasProxy=!1,this.$refs.moveCdp.$refs.modal.show()},setup:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n,r,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.activeCdps={},this.currentCdp={},e=this.web3,a=this,this.gotoHome(),i=Object(gt["a"])(e,a.account.address,Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a.$route.path.includes("maker-sai")){t.next=3;break}return t.next=3,a.doUpdate();case 3:case"end":return t.stop()}}),t)})))),t.next=8,ct.a.create("inject",{provider:{inject:e.currentProvider},plugins:[i],accounts:{myLedger1:{type:"mew"}}});case 8:return this.maker=t.sent,t.next=11,this.maker.authenticate();case 11:return this._priceService=this.maker.service("price"),t.next=14,this.maker.service("cdp");case 14:return this._cdpService=t.sent,t.next=17,this.maker.service("proxy");case 17:return this._proxyService=t.sent,t.next=20,this.maker.service("token");case 20:return this._tokenService=t.sent,this.pethMin=Ct(.005),t.t0=Ct,t.next=25,this._priceService.getEthPrice();case 25:return t.t1=t.sent.toNumber(),this.ethPrice=(0,t.t0)(t.t1),t.t2=Ct,t.next=30,this._priceService.getPethPrice();case 30:return t.t3=t.sent.toNumber(),this.pethPrice=(0,t.t2)(t.t3),t.t4=Ct,t.next=35,this._priceService.getPethPrice();case 35:return t.t5=t.sent.toNumber(),this._targetPrice=(0,t.t4)(t.t5),t.t6=Ct,t.next=40,this._cdpService.getLiquidationRatio();case 40:return t.t7=t.sent,this.liquidationRatio=(0,t.t6)(t.t7),t.t8=Ct,t.next=45,this._cdpService.getLiquidationPenalty();case 45:return t.t9=t.sent,this.liquidationPenalty=(0,t.t8)(t.t9),t.t10=Ct,t.next=50,this._cdpService.getAnnualGovernanceFee();case 50:return t.t11=t.sent,this.stabilityFee=(0,t.t10)(t.t11),t.t12=Ct,t.next=55,this._priceService.getWethToPethRatio();case 55:return t.t13=t.sent,this.wethToPethRatio=(0,t.t12)(t.t13),t.next=59,this._proxyService.currentProxy();case 59:return this.proxyAddress=t.sent,this.daiToken=this._tokenService.getToken(kt),t.next=63,this.daiToken.balance();case 63:return this.daiBalance=t.sent.toBigNumber(),this.mkrToken=this._tokenService.getToken(bt),t.next=67,this.mkrToken.balance();case 67:return this.mkrBalance=t.sent.toBigNumber(),n=Ct(this.pethMin).times(this.wethToPethRatio),this.systemValues={stabilityFee:this.stabilityFee,minEth:n,liquidationRatio:this.liquidationRatio,wethToPethRatio:this.wethToPethRatio,liquidationPenalty:this.liquidationPenalty,targetPrice:this._targetPrice,pethPrice:this.pethPrice},t.next=72,this.checkAllowances();case 72:return t.next=74,this.locateCdps();case 74:if(r=t.sent,o=r.withProxy,c=r.withoutProxy,this.cdps=o,this.cdpsWithoutProxy=c,!(this.cdps.length>0||this.cdpsWithoutProxy.length>0)){t.next=82;break}return t.next=82,this.loadCdpDetails();case 82:this.currentProxy=this.getProxy(),this.cdps.length>0||this.cdpsWithoutProxy.length>0?(this.cdpDetailsLoaded=!0,this.makerActive=!0,"create-sai"!==this.$route.name&&this.$route.path.includes("maker-sai")&&this.goToManage()):this.gotoCreate();case 84:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),buildEmpty:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.buildCdpObject(null);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),addCdp:function(){this.creatingCdp=!0},removeCdp:function(t){try{delete this.availableCdps[t.id],ut["e"].responseHandler(this.$t("dapps-maker.cdp-closed"),ut["e"].INFO)}catch(e){console.error(e)}},migrateCdpExternal:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.afterUpdate.push(this.goToManage),t.next=3,this.migrateCdp(e);case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),refreshExternal:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.doUpdate();case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),refresh:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.doUpdate();case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),doUpdate:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n,r,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getProxy();case 2:return this.proxyAddress=t.sent,e=!1,a="create-sai"===this.$route.name,t.next=7,this.updateActiveCdp();case 7:i=regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!s.activeCdps[a].needsUpdate){t.next=16;break}if(!s.activeCdps[a].closing){t.next=8;break}e=!0,delete s.activeCdps[a],s.cdps=s.cdps.filter((function(t){return t!==a})),s.cdpsWithoutProxy=s.cdpsWithoutProxy.filter((function(t){return t!==a})),t.next=16;break;case 8:if(!s.activeCdps[a].opening){t.next=13;break}return t.next=11,s.activeCdps[a].updateValues();case 11:t.next=16;break;case 13:return t.next=15,s.activeCdps[a].update();case 15:s.activeCdps[a]=t.sent;case 16:if(a!==s.currentCdpId){t.next=21;break}return t.next=19,s.currentCdp.update();case 19:return t.next=21,s.setupCdpManage(s.currentCdpId);case 21:case"end":return t.stop()}}),t)})),t.t0=regeneratorRuntime.keys(this.activeCdps);case 9:if((t.t1=t.t0()).done){t.next=14;break}return n=t.t1.value,t.delegateYield(i(n),"t2",12);case 12:t.next=9;break;case 14:return t.next=16,this.daiToken.balance();case 16:return this.daiBalance=t.sent.toBigNumber(),t.next=19,this.mkrToken.balance();case 19:return this.mkrBalance=t.sent.toBigNumber(),t.next=22,this.checkAllowances();case 22:if(Object.keys(this.activeCdps).includes(this.currentCdpId)){t.next=29;break}return t.next=25,this.loadCdpDetails();case 25:return t.next=27,this.setupCdpManage(this.currentCdpId);case 27:t.next=31;break;case 29:return t.next=31,this.setupCdpManage(this.currentCdpId);case 31:if(r=function t(){if(s.afterUpdate.length>0){var e=s.afterUpdate.pop();e(),t()}},r(),(e||a||this.creatingCdp)&&(this.cdps.length>0||this.cdpsWithoutProxy.length>0?this.goToManage():this.gotoCreate()),!this.creatingCdp){t.next=41;break}return this.creatingCdp=!1,t.next=38,this.updateActiveCdp();case 38:ut["e"].responseHandler(this.$t("dapps-maker.cdp-closed"),ut["e"].INFO),t.next=43;break;case 41:this.valuesUpdated++,ut["e"].responseHandler(this.$t("dapps-maker.cdp-closed"),ut["e"].INFO);case 43:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),checkAllowances:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.proxyAddress){t.next=7;break}return t.next=3,this.daiToken.allowance(this.account.address,this.proxyAddress);case 3:return this._proxyAllowanceDai=t.sent.toBigNumber(),t.next=6,this.mkrToken.allowance(this.account.address,this.proxyAddress);case 6:this._proxyAllowanceMkr=t.sent.toBigNumber();case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setupCdpManage:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.allCdpIds.includes(e)&&this.allCdpIds.length>0&&(e=this.allCdpIds[0]),0!==this.allCdpIds.length){t.next=5;break}this.activeValues=this.systemValues,t.next=9;break;case 5:return this.currentCdpId=e,t.next=8,this.getValuesForManage(e);case 8:this.activeValues=t.sent;case 9:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getValuesForManage:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,i,n,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=this.activeCdps[e],this.currentCdp=a,i=this._proxyAllowanceDai,n=this._proxyAllowanceMkr,r=this.toPeth,s=this.systemValues,t.abrupt("return",xt({},s,{cdpId:e,maxPethDraw:a.maxPethDraw,maxEthDraw:a.maxEthDraw,maxUsdDraw:a.maxUsdDraw,ethCollateral:a.ethCollateral,pethCollateral:a.pethCollateral,usdCollateral:a.usdCollateral,debtValue:a.debtValue,maxDai:a.maxDai,collateralRatio:a.collatRatio,liquidationPrice:a.liquidationPrice,minEth:a.minEth,isSafe:!1,governanceFeeOwed:a.governanceFeeOwed,ethCollateralNum:a.ethCollateralNum,toPeth:r,proxyAllowanceDai:i,proxyAllowanceMkr:n,zeroDebt:a.zeroDebt}));case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),locateCdps:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.cdpsWithoutProxy=[],t.next=3,this.locateCdpsWithoutProxy();case 3:return this.cdpsWithoutProxy=t.sent,this.cdps=[],t.next=7,this.locateCdpsProxy();case 7:return this.cdps=t.sent,this.allCdpIds=[].concat(Object(r["a"])(this.cdpsWithoutProxy),Object(r["a"])(this.cdps)),t.abrupt("return",{withProxy:this.cdps,withoutProxy:this.cdpsWithoutProxy});case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),locateCdpsWithoutProxy:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this._cdpService.getCdpIds(this.account.address);case 2:return e=t.sent,t.next=5,this._cdpService.getCdpIds(Object(ft["b"])(this.account.address));case 5:return a=t.sent,t.abrupt("return",e.concat(a));case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),locateCdpsProxy:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getProxy();case 2:return this.proxyAddress=t.sent,t.next=5,this._cdpService.getCdpIds(this.proxyAddress);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),updateActiveCdp:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n,r,s,o=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=Object.keys(this.activeCdps),t.next=3,this.locateCdps();case 3:if(a=this.cdps.filter((function(t){return!Object.keys(o.activeCdps).includes(t.toString())})),i=this.cdpsWithoutProxy.filter((function(t){return!Object.keys(o.activeCdps).includes(t.toString())})),n=e.filter((function(t){return!(o.cdps.includes(t.toString())||o.cdpsWithoutProxy.includes(t.toString()))})),n.length>0&&n.forEach((function(t){return delete o.activeCdps[t]})),!(a.length>0)){t.next=16;break}r=0;case 9:if(!(r<a.length)){t.next=16;break}return t.next=12,this.buildCdpObject(a[r]);case 12:this.activeCdps[a[r]]=t.sent;case 13:r++,t.next=9;break;case 16:if(!(i.length>0)){t.next=25;break}s=0;case 18:if(!(s<i.length)){t.next=25;break}return t.next=21,this.buildCdpObject(i[s],{noProxy:!0});case 21:this.activeCdps[i[s]]=t.sent;case 22:s++,t.next=18;break;case 25:0===this.cdps.length&&0===this.cdpsWithoutProxy.length&&this.gotoCreate();case 26:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadCdpDetails:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=0;case 1:if(!(e<this.cdps.length)){t.next=8;break}return t.next=4,this.buildCdpObject(this.cdps[e]);case 4:this.activeCdps[this.cdps[e]]=t.sent;case 5:e++,t.next=1;break;case 8:a=0;case 9:if(!(a<this.cdpsWithoutProxy.length)){t.next=16;break}return t.next=12,this.buildCdpObject(this.cdpsWithoutProxy[a],{noProxy:!0});case 12:this.activeCdps[this.cdpsWithoutProxy[a]]=t.sent;case 13:a++,t.next=9;break;case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),buildCdpObject:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,i,n,r,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=s.length>1&&void 0!==s[1]?s[1]:{},i=xt({},a,{_proxyAddress:this.proxyAddress,liquidationPenalty:this.liquidationPenalty,stabilityFee:this.stabilityFee,ethPrice:this.ethPrice,_pethPrice:this.pethPrice,wethToPethRatio:this.wethToPethRatio,_targetPrice:this._targetPrice,liquidationRatio:this.liquidationRatio,proxyAllowanceDai:this.proxyAllowanceDai,proxyAllowanceMkr:this.proxyAllowanceMkr,_daiToken:this._daiToken,daiBalance:this.daiBalance,_mkrToken:this._mkrToken,mkrBalance:this.mkrBalance,minEth:this.minEth,pethMin:this.pethMin}),!this.cdpsWithoutProxy.includes(e)){t.next=8;break}return t.next=5,this.getMakerCdp(e,!1);case 5:this.cdp=t.sent,t.next=17;break;case 8:if(!this.cdps.includes(e)){t.next=14;break}return t.next=11,this.getMakerCdp(e,this.proxyAddress);case 11:this.cdp=t.sent,t.next=17;break;case 14:return t.next=16,this.getMakerCdp(e,!1);case 16:this.cdp=t.sent;case 17:if(n={_proxyService:this._proxyService,priceService:this.priceService,_cdpService:this._cdpService,doUpdate:this.doUpdate,getProxy:this.getProxy,hasProxy:this.hasProxy,getCdp:this.getMakerCdp,toPeth:this.toPeth,toUSD:this.toUSD,_proxyAddress:this.proxyAddress,liquidationPenalty:this.liquidationPenalty,stabilityFee:this.stabilityFee,ethPrice:this.ethPrice,_pethPrice:this.pethPrice,wethToPethRatio:this.wethToPethRatio,_targetPrice:this._targetPrice,liquidationRatio:this.liquidationRatio,proxyAllowanceDai:this.proxyAllowanceDai,proxyAllowanceMkr:this.proxyAllowanceMkr,_daiToken:this._daiToken,daiBalance:this.daiBalance,_mkrToken:this._mkrToken,mkrBalance:this.mkrBalance,minEth:this.minEth,pethMin:this.pethMin},r=new mt(e,this.web3,n,i),!e){t.next=23;break}return t.next=22,r.init(e);case 22:return t.abrupt("return",t.sent);case 23:return t.abrupt("return",r);case 24:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getProxy:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this._proxyService.currentProxy();case 2:if(this.proxyAddress=t.sent,this.proxyAddress){t.next=8;break}return t.next=6,this._proxyService.getProxyAddress(this.account.address);case 6:this.proxyAddress=t.sent,this.proxyAddress&&(this.noProxy=!1);case 8:return t.abrupt("return",this.proxyAddress);case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),lockEth:function(t){this.currentCdp.lockEth(t)},wipeDai:function(t){this.currentCdp.wipeDai(t)},freeEth:function(t){null===t[1]?this.currentCdp.freeEth(t[0]):this.currentCdp.freeEth(t[0],t[1])},drawDai:function(t){null===t[1]?this.currentCdp.drawDai(t[0]):this.currentCdp.drawDai(t[0],t[1])},closeCdp:function(){this.currentCdp.closeCdp()},checkIfDestAddressHasProxy:function(t){var e=this;this.currentCdp.checkIfDestAddressHasProxy(t).then((function(t){e.destAddressProxy=t,e.destAddressHasProxy=null!==t})).catch((function(t){throw t}))},moveCdp:function(t){this.currentCdp.moveCdp(t)},calcCollatRatioDaiChg:function(t){return Ct(this.currentCdp.calcCollatRatio(this.currentCdp.ethCollateral,t))},calcCollatRatioEthChg:function(t){return Ct(this.currentCdp.calcCollatRatio(t,this.currentCdp.debtValue))},calcLiquidationPriceDaiChg:function(t){return Ct(this.currentCdp.calcLiquidationPrice(this.currentCdp.ethCollateral,t))},calcLiquidationPriceEthChg:function(t){return Ct(this.currentCdp.calcLiquidationPrice(t,this.currentCdp.debtValue))},approveDai:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this._tokenService.getToken(kt).approveUnlimited(this.proxyAddress);case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),approveMkr:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this._tokenService.getToken(bt).approveUnlimited(this.proxyAddress);case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),hasCdp:function(t){return Object.keys(this.activeCdps).includes(Ct(t).toString())},getCdp:function(t){return this.activeCdps[t]},getMakerCdp:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!==e){t.next=2;break}return t.abrupt("return");case 2:if(!this.cdpsWithoutProxy.includes(e)){t.next=8;break}return t.next=5,this.maker.getCdp(e,!1);case 5:return t.abrupt("return",t.sent);case 8:if(!this.cdps.includes(e)||!this.proxyAddress){t.next=14;break}return t.next=11,this.maker.getCdp(e,this.proxyAddress);case 11:return t.abrupt("return",t.sent);case 14:if(!this.proxyAddress){t.next=18;break}return t.next=17,this.maker.getCdp(e,this.proxyAddress);case 17:return t.abrupt("return",t.sent);case 18:return t.next=20,this.maker.getCdp(e,!1);case 20:return t.abrupt("return",t.sent);case 21:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),buildProxy:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getProxy();case 2:if(this.proxyAddress=t.sent,this.proxyAddress){t.next=10;break}return t.next=6,this._proxyService.build();case 6:return t.next=8,this._proxyService.currentProxy();case 8:return this.proxyAddress=t.sent,t.abrupt("return",this.proxyAddress);case 10:return t.next=12,this._proxyService.currentProxy();case 12:return this.proxyAddress=t.sent,t.abrupt("return",this.proxyAddress);case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),migrateCdp:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getProxy();case 2:if(a=t.sent,!a){t.next=6;break}return t.next=6,this._cdpService.give(e,a);case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),minEth:function(){return this.wethToPethRatio?Ct(this.pethMin).times(this.wethToPethRatio):"--"},toUSD:function(t){return void 0===t||null===t?Ct(0):this.ethPrice.times(Ct(t))},toPeth:function(t){return Ct(t).eq(0)?Ct(0):Ct(t).div(this.wethToPethRatio)}}},_t=Pt,Rt=(a("e0cd"),Object(A["a"])(_t,i,n,!1,null,"7ca66791",null));e["default"]=Rt.exports},"2fb38":function(t,e,a){"use strict";var i=a("783a"),n=a.n(i);n.a},"71a4":function(t,e,a){"use strict";var i=a("16ca"),n=a.n(i);n.a},"783a":function(t,e,a){},"8a41":function(t,e,a){},"9393d":function(t,e,a){"use strict";var i=a("bdaa"),n=a.n(i);n.a},bdaa:function(t,e,a){},cd2e:function(t,e,a){},d2bc:function(t,e,a){"use strict";var i=a("8a41"),n=a.n(i);n.a},e0cd:function(t,e,a){"use strict";var i=a("cd2e"),n=a.n(i);n.a}}]);
//# sourceMappingURL=chunk-309a70c6.48fb1a1a.js.map